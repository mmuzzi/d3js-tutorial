<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3.js - Brazil Choropleth</title>
        <script src="lib/d3.v3.js"></script>
        <script src="http://d3js.org/topojson.v1.min.js"></script>
        <style>
            .path {
                fill: lightgray;
                stroke: #000;
            }
        </style>
    </head>
    <body>
        <script>
            var width = 960,
                height = 960;
            
            var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);

            var projection = d3.geo.conicEqualArea()
                .parallels([15.0, -20.0])
                // dummy scale and translate value
                .scale(1)
                .translate([0, 0]);

            var path = d3.geo.path()
                .projection(projection);

            d3.json("data/bra.json", function(error, bra) {
                if (error) throw error;

                var states = topojson.feature(bra, bra.objects.states2);

                // Fit projection
                var b = path.bounds(states),
                    s = .95 / Math.max((b[1][0] - b[0][0]) / width,
                        (b[1][1] - b[0][1]) / height),
                    t = [(width - s * (b[1][0] + b[0][0])) / 2,
                        (height - s * (b[1][1] + b[0][1])) / 2];
                
                projection.scale(s)
                    .translate(t);

                path = path.projection(projection);

                // console.log(states);

                // Plot paths
                svg.append("path")
                    .datum(states)
                    .attr("d", path)
                    .attr("class", "path");

            });

        </script>
    </body>
</html>
